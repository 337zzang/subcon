# 매입대사 시스템 요구사항 분석

## 1. 비즈니스 요구사항

### 1.1 배경
- 현재 매입 데이터와 세금계산서, 지불 내역의 대사가 수동으로 진행되고 있음
- 데이터 양이 많고 복잡한 매칭 규칙으로 인해 오류 발생 가능성이 높음
- 월별 마감 시기에 대사 작업으로 인한 업무 부담이 큼

### 1.2 목표
- 매입 대사 프로세스의 완전 자동화
- 대사 정확도 향상 (오류율 0.1% 이하)
- 처리 시간 단축 (현재 대비 90% 감소)
- 이상 내역의 즉각적인 감지 및 보고

## 2. 기능 요구사항

### 2.1 데이터 입력
- **FR-001**: 5개의 Excel 파일을 동시에 읽어올 수 있어야 함
- **FR-002**: 잘못된 형식의 데이터를 감지하고 오류를 보고해야 함
- **FR-003**: 대용량 파일(10만 행 이상)도 처리 가능해야 함

### 2.2 데이터 처리
- **FR-004**: 협력사별, 월별로 매입 데이터를 집계할 수 있어야 함
- **FR-005**: 과세/면세 구분에 따른 자동 분류가 가능해야 함
- **FR-006**: 중복 데이터를 자동으로 제거해야 함

### 2.3 대사 기능
- **FR-007**: 1:1 금액 매칭을 우선적으로 수행해야 함
- **FR-008**: 1:N 순차 매칭을 지원해야 함
- **FR-009**: 부분 매칭 케이스를 처리할 수 있어야 함
- **FR-010**: 매칭 불가 항목을 별도로 분류해야 함

### 2.4 지불 검증
- **FR-011**: 세금계산서와 실제 지불 내역을 대사해야 함
- **FR-012**: 지불 기간별 분류(10일/15일/30일/30일초과)가 가능해야 함
- **FR-013**: 이전/이후 기간 지불 건을 식별해야 함

### 2.5 리포트 생성
- **FR-014**: 5개 시트로 구성된 Excel 리포트를 생성해야 함
- **FR-015**: 리포트에 적절한 서식과 스타일이 적용되어야 함
- **FR-016**: 대사 결과 요약 정보를 제공해야 함

## 3. 비기능 요구사항

### 3.1 성능
- **NFR-001**: 10만 건 데이터 처리 시 5분 이내 완료
- **NFR-002**: 메모리 사용량 2GB 이하
- **NFR-003**: CPU 사용률 80% 이하

### 3.2 신뢰성
- **NFR-004**: 대사 정확도 99.9% 이상
- **NFR-005**: 시스템 가용성 99% 이상
- **NFR-006**: 데이터 무결성 보장

### 3.3 유지보수성
- **NFR-007**: 모듈화된 구조로 개발
- **NFR-008**: 충분한 로깅 및 디버깅 정보 제공
- **NFR-009**: 설정 변경이 용이한 구조

### 3.4 사용성
- **NFR-010**: 명령줄 인터페이스 제공
- **NFR-011**: 진행 상황 표시
- **NFR-012**: 명확한 오류 메시지

## 4. 데이터 요구사항

### 4.1 입력 데이터
| 파일명 | 필수 컬럼 | 데이터 타입 | 비고 |
|--------|----------|------------|------|
| 협력사단품별매입 | 년월, 협력사코드, 협력사명, 단품코드, 단품명, 면과세구분명, 최종매입금액 | Float/String | 핵심 매입 데이터 |
| 기준 | 협력사코드, 협력사명, 단품코드, 단품명 | String/Int | 마스터 데이터 |
| 매입세금계산서(WIS) | 협력사코드, 계산서작성일, 공급가액, 세액 | Various | WIS 시스템 데이터 |
| 매입세금계산서 | 국세청승인번호, 국세청작성일, 국세청발급일 | String/Date | 국세청 데이터 |
| 지불보조장 | 회계일, 전표번호, 거래처번호, 차변금액 | Various | 지불 데이터 |

### 4.2 출력 데이터
- 최종총괄장내역: 대사 완료된 최종 결과
- 대사총괄장내역: 상세 대사 과정
- 지불보조장내역: 매칭된 지불 정보
- 세금계산서내역: 처리된 세금계산서
- 요청단품내역: 대사 대상 마스터

## 5. 제약사항

### 5.1 기술적 제약
- Windows 환경에서만 실행 (win32com 의존성)
- Python 3.8 이상 필요
- Excel 설치 필요

### 5.2 비즈니스 제약
- 월 마감 전까지 처리 완료 필요
- 세금계산서 발급일 기준 최대 3개월까지 대사
- 협력사 코드 체계 준수 필요

## 6. 가정사항

- 입력 파일의 위치와 이름은 고정됨
- 데이터 형식은 현재 구조를 유지
- 협력사 코드와 사업자번호는 1:1 매칭
- 모든 금액은 원 단위로 입력

## 7. 리스크 및 대응방안

### 7.1 데이터 품질 리스크
- **리스크**: 입력 데이터의 오류나 누락
- **대응**: 데이터 검증 강화, 오류 리포트 생성

### 7.2 성능 리스크
- **리스크**: 대용량 데이터 처리 시 성능 저하
- **대응**: 청크 단위 처리, 병렬 처리 도입

### 7.3 운영 리스크
- **리스크**: 사용자 교육 부족으로 인한 오작동
- **대응**: 상세한 사용자 가이드, 교육 프로그램

## 8. 성공 기준

- 월 마감 시 대사 작업 시간 90% 단축
- 대사 오류율 0.1% 이하
- 사용자 만족도 90% 이상
- 시스템 안정성 99% 이상
